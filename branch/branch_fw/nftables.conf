table inet fw {
  set internal_nets {
    type ipv4_addr;
    flags interval;
  }
  chain input {
    type filter hook input priority 0;
    counter accept
  }

  chain forward {
    type filter hook forward priority 0;
    counter accept
  }

  chain output {
    type filter hook output priority 0;
    ct state established,related accept
    meta l4proto icmp counter accept
    counter accept
  }
}

table ip nat {
  
  chain PREROUTING {
    type nat hook prerouting priority -100;
    # RDP / SSH to srv_branch_bastion
    tcp dport 8888 counter dnat to 10.97.23.200:8888
    tcp dport 43389 counter dnat to 10.97.23.66:3389
    udp dport 43389 counter dnat to 10.97.23.66:3389
    tcp dport 2222 counter dnat to 10.97.23.66:22
    udp dport 2222 counter dnat to 10.97.23.66:22
  }

  chain POSTROUTING {
    type nat hook postrouting priority 100;    
    oifname "eth_uplink" masquerade  # Generic egress to inet
  }
}
