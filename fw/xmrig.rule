alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"ET POLICY Crypto Coin Miner Login (xmrig/stratum)"; flow:established,to_server; content:"|7b|"; content:"method"; content:"login"; content:"agent"; content:"xmrig"; fast_pattern; classtype:policy-violation; sid:1000001; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"ET POLICY Cryptocurrency Mining Activity (Stratum Protocol)"; flow:established,to_server; content:"{\"id\":"; content:"\"method\":\"submit\""; content:"\"params\":"; distance:0; classtype:policy-violation; sid:1000002; rev:1;)
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ATTACKER XMRig Miner Download Attempt"; flow:established,to_server; http.method; content:"GET"; http.uri; content:"/xmrig/releases/download/"; content:".tar.gz"; distance:0; classtype:policy-violation; sid:1000003; rev:1;)
alert dns $HOME_NET any -> any any (msg:"ATTACKER Crypto Miner Pool Lookup (moneroocean.stream)"; dns.query; content:"moneroocean.stream"; nocase; classtype:policy-violation; sid:1000004; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET 10128 (msg:"ATTACKER XMRig Miner Login (MoneroOcean Port)"; flow:established,to_server; content:"|7b|"; content:"\"method\""; content:"\"login\""; content:"\"agent\""; content:"xmrig"; distance:0; fast_pattern; classtype:policy-violation; sid:1000005; rev:1;)
